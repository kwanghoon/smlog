
datatype ty = Int 
            | Fun of ty * ty 
            | O of ty

datatype term = Var of string | Lam of ty * string * term | App of term * term
              | Next of term  | Prev of term 

datatype time = Z | S of time

type typingenv = (string * ty * time) list

fun member : (typingenv, string, ty, time)

fun member ( (X,T,N) :: E, X, T, N).
    member ( _ :: E, X, T, N) = member (E, X, T, N).

fun typing : (typingenv, term, ty, time)

fun typing (E, Var X, T, N) 
       = member (E, X, T, N).

    typing (E, Lam (X,T,M), Fun (T,T'), N) 
       = typing ((X,T) :: E, M, T', N).

    typing (E, App (M1,M2), T, N)
       = typing (E, M1, Fun (T2,T), N),
         typing (E, M2, T2, N).

    typing (E, Next M, O T, N)
       = typing (E, M, T, S N).

    typing (E, Prev M, T, S N)
       = typing (E, M, O T, N)

