

(* 
   Puzzle: Man, Wolf, Goat, Cabbage
*)

fun member : (int, int list, bool)

fun member (X, [], false).
    member (X, X::XS, true).
    member (X, Y::XS, B) = member (X, XS, B).

fun move : (int, int)

fun move (1010, 0010).
    move (1010, 0000).

    move (1011, 0001).
    move (1011, 0010).

    move (1101, 0101).
    move (1101, 0001).
    move (1101, 0100).

    move (1110, 0010).
    move (1110, 0100).

    move (1111, 0101).

(*
    move ({M=true, W=false, G=true,  C=false}, {M=false, W=false, G=true, C=false}).
    move ({M=true, W=false, G=true,  C=false}, {M=false, W=false, G=false, C=false}).

    move ({M=true, W=false, G=true,  C=true},  {M=false, W=false, G=false, C=true}).
    move ({M=true, W=false, G=true,  C=true},  {M=false, W=false, G=true,  C=false}).

    move ({M=true, W=true,  G=false, C=true},  {M=false, W=true,  G=false, C=true}).
    move ({M=true, W=true,  G=false, C=true},  {M=false, W=false, G=false, C=true}).
    move ({M=true, W=true,  G=false, C=true},  {M=false, W=true,  G=false, C=false}).

    move ({M=true, W=true,  G=true,  C=false}, {M=false, W=false, G=true, C=false}).
    move ({M=true, W=true,  G=true,  C=false}, {M=false, W=true,  G=false, C=false}).

    move ({M=true, W=true,  G=true,  C=true},  {M=false, W=true,  G=false, C=true}).
*)

fun path : (int list, int list)

fun path (PP, [0000]).
    path (PP, S1 :: S2 :: P) = move (S1,S2), member (S1, PP, false), path (S1 :: PP, S2 :: P).
    path (PP, S1 :: S2 :: P) = move (S2,S1), member (S1, PP, false), path (S1 :: PP, S2 :: P).

fun solve : (int list)

fun solve (1111 :: P) = path ([], 1111 :: P).
